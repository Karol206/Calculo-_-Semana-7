<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Derivada por Definición Paso a Paso</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.6.4/math.min.js"></script>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 20px; }
    input, button { font-size: 16px; padding: 8px; margin: 10px 0; }
    #pasos { background: white; padding: 15px; border-radius: 10px; }
  </style>
</head>
<body>

<h2>Derivada por Definición (Paso a Paso)</h2>
<input type="text" id="funcion" placeholder="Ej: 2*x^2">
<button onclick="resolver()">Resolver Derivada</button>

<div id="pasos"></div>

<script>
  function resolver() {
    const entrada = document.getElementById("funcion").value;
    const pasos = document.getElementById("pasos");
    pasos.innerHTML = "";

    try {
      // Paso 1
      const f = math.simplify(entrada).toString();
      pasos.innerHTML += `<p><strong>Paso 1:</strong> f(x) = ${f}</p>`;

      // Paso 2
      const fx_dx = entrada.replace(/x/g, "(x + h)");
      const fx_menos_f = `(${fx_dx}) - (${entrada})`;
      pasos.innerHTML += `<p><strong>Paso 2:</strong> f(x+h) = ${fx_dx}</p>`;
      pasos.innerHTML += `<p><strong>Paso 3:</strong> [f(x+h) - f(x)] / h = [${fx_dx} - (${entrada})]/h</p>`;

      // Paso 4: simplificar numerador
      const numerador = math.simplify(fx_menos_f).toString();
      pasos.innerHTML += `<p><strong>Paso 4:</strong> Simplificando el numerador: ${numerador}</p>`;

      // Paso 5: cociente / h
      const cociente = math.simplify(`(${numerador}) / h`).toString();
      pasos.innerHTML += `<p><strong>Paso 5:</strong> Dividiendo por h: ${cociente}</p>`;

      // Paso 6: límite cuando h → 0
      const derivada = math.derivative(entrada, 'x').toString();
      pasos.innerHTML += `<p><strong>Paso 6:</strong> Derivada final: ${derivada}</p>`;

    } catch (e) {
      pasos.innerHTML = `<p style="color: red;">⚠️ Error al procesar la función. Usa formato como: <code>2*x^2</code></p>`;
    }
  }
</script>

</body>
</html>
